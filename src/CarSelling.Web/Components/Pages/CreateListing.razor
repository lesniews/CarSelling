@page "/create-listing"
@inject ICarListingApiService CarListingService
@inject NavigationManager Navigation
@using CarSelling.Shared.DTOs
@using CarSelling.Web.Services
@using CarSelling.Shared.Models

<PageTitle>Sell Your Car - CarMarket</PageTitle>

<div class="create-listing-container">
    <!-- Hero Section -->
    <div class="create-listing-hero">
        <div class="container">
            <div class="hero-content">
                <h1 class="hero-title">Sell Your Car with Confidence</h1>
                <p class="hero-subtitle">Reach thousands of potential buyers with our comprehensive listing platform</p>
                <div class="progress-indicator">
                    <div class="step @(currentStep >= 1 ? "active" : "")">
                        <div class="step-number">1</div>
                        <span>Vehicle Details</span>
                    </div>
                    <div class="step @(currentStep >= 2 ? "active" : "")">
                        <div class="step-number">2</div>
                        <span>Features & Condition</span>
                    </div>
                    <div class="step @(currentStep >= 3 ? "active" : "")">
                        <div class="step-number">3</div>
                        <span>Pricing & Contact</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Form Content -->
    <div class="container">
        <div class="form-container">
            <EditForm Model="@createModel" OnValidSubmit="@HandleValidSubmit">
                <DataAnnotationsValidator />
                
                @if (showValidationSummary)
                {
                    <div class="validation-summary">
                        <ValidationSummary />
                    </div>
                }

                <!-- Step 1: Vehicle Details -->
                @if (currentStep == 1)
                {
                    <div class="form-step active">
                        <div class="step-header">
                            <h2>Vehicle Details</h2>
                            <p>Tell us about your car's basic information</p>
                        </div>

                        <div class="form-grid">
                            <!-- Basic Info Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12a3 3 0 116 0 3 3 0 01-6 0z"></path>
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14h2l-2-8H5l-2 8h2m6 5a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                        </svg>
                                        Basic Information
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-field full-width">
                                        <label class="field-label">Listing Title *</label>
                                        <InputText @bind-Value="createModel.Title" class="field-input" placeholder="e.g., 2023 Honda Civic Sport - Excellent Condition, Low Miles" />
                                        <ValidationMessage For="@(() => createModel.Title)" />
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Make *</label>
                                            <InputSelect @bind-Value="createModel.Make" class="field-select">
                                                <option value="">Select Make</option>
                                                <option value="Toyota">Toyota</option>
                                                <option value="Honda">Honda</option>
                                                <option value="Tesla">Tesla</option>
                                                <option value="BMW">BMW</option>
                                                <option value="Mercedes">Mercedes</option>
                                                <option value="Audi">Audi</option>
                                                <option value="Ford">Ford</option>
                                                <option value="Chevrolet">Chevrolet</option>
                                                <option value="Nissan">Nissan</option>
                                                <option value="Hyundai">Hyundai</option>
                                                <option value="Other">Other</option>
                                            </InputSelect>
                                            <ValidationMessage For="@(() => createModel.Make)" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Model *</label>
                                            <InputText @bind-Value="createModel.Model" class="field-input" placeholder="Civic" />
                                            <ValidationMessage For="@(() => createModel.Model)" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Year *</label>
                                            <InputNumber @bind-Value="createModel.Year" class="field-input" />
                                            <ValidationMessage For="@(() => createModel.Year)" />
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Body Type</label>
                                            <InputSelect @bind-Value="createModel.BodyType" class="field-select">
                                                <option value="">Select Body Type</option>
                                                <option value="Sedan">Sedan</option>
                                                <option value="SUV">SUV</option>
                                                <option value="Hatchback">Hatchback</option>
                                                <option value="Coupe">Coupe</option>
                                                <option value="Convertible">Convertible</option>
                                                <option value="Truck">Truck</option>
                                                <option value="Van">Van</option>
                                                <option value="Wagon">Wagon</option>
                                            </InputSelect>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Mileage *</label>
                                            <div class="input-with-suffix">
                                                <InputNumber @bind-Value="createModel.Mileage" class="field-input" />
                                                <span class="input-suffix">miles</span>
                                            </div>
                                            <ValidationMessage For="@(() => createModel.Mileage)" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">VIN</label>
                                            <InputText @bind-Value="createModel.VIN" class="field-input" placeholder="Optional" />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Engine & Performance Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                        </svg>
                                        Engine & Performance
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Fuel Type</label>
                                            <InputSelect @bind-Value="createModel.FuelType" class="field-select">
                                                <option value="">Select Fuel Type</option>
                                                <option value="Gasoline">Gasoline</option>
                                                <option value="Diesel">Diesel</option>
                                                <option value="Hybrid">Hybrid</option>
                                                <option value="Electric">Electric</option>
                                                <option value="Plug-in Hybrid">Plug-in Hybrid</option>
                                            </InputSelect>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Transmission</label>
                                            <InputSelect @bind-Value="createModel.Transmission" class="field-select">
                                                <option value="">Select Transmission</option>
                                                <option value="Manual">Manual</option>
                                                <option value="Automatic">Automatic</option>
                                                <option value="CVT">CVT</option>
                                                <option value="Semi-Automatic">Semi-Automatic</option>
                                            </InputSelect>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Drivetrain</label>
                                            <InputSelect @bind-Value="createModel.Drivetrain" class="field-select">
                                                <option value="">Select Drivetrain</option>
                                                <option value="FWD">Front-Wheel Drive</option>
                                                <option value="RWD">Rear-Wheel Drive</option>
                                                <option value="AWD">All-Wheel Drive</option>
                                                <option value="4WD">4-Wheel Drive</option>
                                            </InputSelect>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Engine Size</label>
                                            <InputText @bind-Value="createModel.EngineSize" class="field-input" placeholder="e.g., 2.0L, 3.5L V6" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Horsepower</label>
                                            <div class="input-with-suffix">
                                                <InputNumber @bind-Value="createModel.Horsepower" class="field-input" />
                                                <span class="input-suffix">HP</span>
                                            </div>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Fuel Economy</label>
                                            <div class="fuel-economy-inputs">
                                                <div class="economy-input">
                                                    <InputNumber @bind-Value="createModel.FuelEconomyCity" class="field-input" placeholder="City" />
                                                    <span>City</span>
                                                </div>
                                                <div class="economy-input">
                                                    <InputNumber @bind-Value="createModel.FuelEconomyHighway" class="field-input" placeholder="Hwy" />
                                                    <span>Highway</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-navigation">
                            <button type="button" class="btn btn-primary btn-large" @onclick="NextStep">
                                Continue to Features
                                <svg class="btn-icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                }

                <!-- Step 2: Features & Condition -->
                @if (currentStep == 2)
                {
                    <div class="form-step active">
                        <div class="step-header">
                            <h2>Features & Condition</h2>
                            <p>Help buyers understand your car's condition and features</p>
                        </div>

                        <div class="form-grid">
                            <!-- Condition & History Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                        </svg>
                                        Condition & History
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Overall Condition</label>
                                            <InputSelect @bind-Value="createModel.Condition" class="field-select">
                                                <option value="">Select Condition</option>
                                                <option value="Excellent">Excellent</option>
                                                <option value="Very Good">Very Good</option>
                                                <option value="Good">Good</option>
                                                <option value="Fair">Fair</option>
                                            </InputSelect>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Damage Status</label>
                                            <InputSelect @bind-Value="createModel.DamageStatus" class="field-select">
                                                <option value="">Select Status</option>
                                                <option value="No Damage">No Damage</option>
                                                <option value="Minor Damage">Minor Damage</option>
                                                <option value="Major Damage">Major Damage</option>
                                            </InputSelect>
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Title Status</label>
                                            <InputSelect @bind-Value="createModel.CarStatus" class="field-select">
                                                <option value="">Select Status</option>
                                                <option value="Clean Title">Clean Title</option>
                                                <option value="Salvage">Salvage</option>
                                                <option value="Rebuilt">Rebuilt</option>
                                                <option value="Lemon">Lemon</option>
                                            </InputSelect>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Previous Owners</label>
                                            <InputNumber @bind-Value="createModel.PreviousOwners" class="field-input" />
                                        </div>
                                        <div class="form-field checkbox-field">
                                            <label class="checkbox-label">
                                                <InputCheckbox @bind-Value="createModel.AccidentHistory" class="field-checkbox" />
                                                <span class="checkmark"></span>
                                                Accident History
                                            </label>
                                        </div>
                                        <div class="form-field checkbox-field">
                                            <label class="checkbox-label">
                                                <InputCheckbox @bind-Value="createModel.ServiceHistoryAvailable" class="field-checkbox" />
                                                <span class="checkmark"></span>
                                                Service Records Available
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Colors & Interior Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM7 21a4 4 0 004-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4"></path>
                                        </svg>
                                        Colors & Interior
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Exterior Color</label>
                                            <InputText @bind-Value="createModel.ExteriorColor" class="field-input" placeholder="e.g., Black, White, Silver" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Interior Color</label>
                                            <InputText @bind-Value="createModel.InteriorColor" class="field-input" placeholder="e.g., Black, Beige, Gray" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Interior Material</label>
                                            <InputSelect @bind-Value="createModel.InteriorMaterial" class="field-select">
                                                <option value="">Select Material</option>
                                                <option value="Cloth">Cloth</option>
                                                <option value="Leather">Leather</option>
                                                <option value="Leatherette">Leatherette</option>
                                                <option value="Vinyl">Vinyl</option>
                                                <option value="Alcantara">Alcantara</option>
                                            </InputSelect>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Equipment & Features Card -->
                            <div class="form-card full-width">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                        </svg>
                                        Equipment & Features
                                    </h3>
                                    <p>Select all features that apply to your vehicle</p>
                                </div>
                                <div class="card-content">
                                    <div class="equipment-grid">
                                        @foreach (var equipment in availableEquipment)
                                        {
                                            <label class="equipment-checkbox">
                                                <input type="checkbox" @onchange="@((e) => ToggleEquipment(equipment, (bool)e.Value!))" />
                                                <span class="equipment-checkmark"></span>
                                                <span class="equipment-label">@equipment</span>
                                            </label>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-navigation">
                            <button type="button" class="btn btn-outline" @onclick="PreviousStep">
                                <svg class="btn-icon-left" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                                Back
                            </button>
                            <button type="button" class="btn btn-primary btn-large" @onclick="NextStep">
                                Continue to Pricing
                                <svg class="btn-icon-right" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                }

                <!-- Step 3: Pricing & Contact -->
                @if (currentStep == 3)
                {
                    <div class="form-step active">
                        <div class="step-header">
                            <h2>Pricing & Contact Information</h2>
                            <p>Set your price and let buyers know how to reach you</p>
                        </div>

                        <div class="form-grid">
                            <!-- Pricing Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path>
                                        </svg>
                                        Pricing Information
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Asking Price *</label>
                                            <div class="input-with-prefix">
                                                <span class="input-prefix">$</span>
                                                <InputNumber @bind-Value="createModel.Price" class="field-input" />
                                            </div>
                                            <ValidationMessage For="@(() => createModel.Price)" />
                                        </div>
                                        <div class="form-field checkbox-field">
                                            <label class="checkbox-label">
                                                <InputCheckbox @bind-Value="createModel.NegotiablePrice" class="field-checkbox" />
                                                <span class="checkmark"></span>
                                                Price is negotiable
                                            </label>
                                        </div>
                                        <div class="form-field checkbox-field">
                                            <label class="checkbox-label">
                                                <InputCheckbox @bind-Value="createModel.TradeInAccepted" class="field-checkbox" />
                                                <span class="checkmark"></span>
                                                Accept trade-ins
                                            </label>
                                        </div>
                                    </div>

                                    <div class="form-field">
                                        <label class="field-label">Financing Options</label>
                                        <InputText @bind-Value="createModel.FinancingOptions" class="field-input" placeholder="e.g., Bank financing available, Seller financing" />
                                    </div>
                                </div>
                            </div>

                            <!-- Contact Information Card -->
                            <div class="form-card">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                        </svg>
                                        Contact Information
                                    </h3>
                                </div>
                                <div class="card-content">
                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Email Address *</label>
                                            <InputText @bind-Value="createModel.ContactEmail" class="field-input" type="email" />
                                            <ValidationMessage For="@(() => createModel.ContactEmail)" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Phone Number</label>
                                            <InputText @bind-Value="createModel.ContactPhone" class="field-input" placeholder="(555) 123-4567" />
                                            <ValidationMessage For="@(() => createModel.ContactPhone)" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">Seller Type</label>
                                            <InputSelect @bind-Value="createModel.SellerType" class="field-select">
                                                <option value="">Select Type</option>
                                                <option value="Private Seller">Private Seller</option>
                                                <option value="Professional Dealer">Professional Dealer</option>
                                            </InputSelect>
                                        </div>
                                    </div>

                                    <div class="form-row">
                                        <div class="form-field">
                                            <label class="field-label">Location *</label>
                                            <InputText @bind-Value="createModel.Location" class="field-input" placeholder="City, State" />
                                        </div>
                                        <div class="form-field">
                                            <label class="field-label">ZIP Code</label>
                                            <InputText @bind-Value="createModel.ZipCode" class="field-input" placeholder="12345" />
                                        </div>
                                        <div class="form-field checkbox-field">
                                            <label class="checkbox-label">
                                                <InputCheckbox @bind-Value="createModel.TestDriveAvailable" class="field-checkbox" />
                                                <span class="checkmark"></span>
                                                Test drives available
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Description Card -->
                            <div class="form-card full-width">
                                <div class="card-header">
                                    <h3>
                                        <svg class="card-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                                        </svg>
                                        Description
                                    </h3>
                                    <p>Provide additional details about your vehicle</p>
                                </div>
                                <div class="card-content">
                                    <div class="form-field">
                                        <label class="field-label">Vehicle Description</label>
                                        <InputTextArea @bind-Value="createModel.Description" class="field-textarea" rows="5" 
                                                     placeholder="Describe your car's condition, maintenance history, special features, recent repairs, etc. Be honest and detailed to attract serious buyers." />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="step-navigation">
                            <button type="button" class="btn btn-outline" @onclick="PreviousStep">
                                <svg class="btn-icon-left" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                                Back
                            </button>
                            <button type="submit" class="btn btn-success btn-large" disabled="@isSubmitting">
                                @if (isSubmitting)
                                {
                                    <div class="btn-spinner"></div>
                                }
                                else
                                {
                                    <svg class="btn-icon-left" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                                    </svg>
                                }
                                Create Listing
                            </button>
                        </div>
                    </div>
                }
            </EditForm>
        </div>

        <!-- Tips Sidebar -->
        <div class="tips-sidebar">
            <div class="tips-card">
                <div class="tips-header">
                    <h3>💡 Tips for Success</h3>
                </div>
                <div class="tips-content">
                    @if (currentStep == 1)
                    {
                        <div class="tip-item">
                            <div class="tip-icon">🎯</div>
                            <div class="tip-text">
                                <strong>Accurate Details</strong>
                                <p>Provide exact make, model, and year for better search visibility</p>
                            </div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">📊</div>
                            <div class="tip-text">
                                <strong>Honest Mileage</strong>
                                <p>Accurate mileage builds trust with potential buyers</p>
                            </div>
                        </div>
                    }
                    @if (currentStep == 2)
                    {
                        <div class="tip-item">
                            <div class="tip-icon">✅</div>
                            <div class="tip-text">
                                <strong>Be Honest</strong>
                                <p>Transparent condition reporting prevents issues later</p>
                            </div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">🔧</div>
                            <div class="tip-text">
                                <strong>List Features</strong>
                                <p>More features selected = more buyer interest</p>
                            </div>
                        </div>
                    }
                    @if (currentStep == 3)
                    {
                        <div class="tip-item">
                            <div class="tip-icon">💰</div>
                            <div class="tip-text">
                                <strong>Research Pricing</strong>
                                <p>Check similar listings to price competitively</p>
                            </div>
                        </div>
                        <div class="tip-item">
                            <div class="tip-icon">📱</div>
                            <div class="tip-text">
                                <strong>Respond Quickly</strong>
                                <p>Fast responses lead to more successful sales</p>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

@code {
    private ExtendedCreateCarListingDto createModel = new()
    {
        SellerType = "Private Seller",
        AvailableDate = DateTime.Now,
        TestDriveAvailable = true
    };
    
    private bool isSubmitting = false;
    private bool showValidationSummary = false;
    private int currentStep = 1;
    private const int totalSteps = 3;

    private readonly List<string> availableEquipment = CarEquipment.AvailableEquipment;

    private void NextStep()
    {
        if (currentStep < totalSteps)
        {
            currentStep++;
        }
    }

    private void PreviousStep()
    {
        if (currentStep > 1)
        {
            currentStep--;
        }
    }

    private void ToggleEquipment(string equipment, bool selected)
    {
        if (selected)
        {
            if (!createModel.Equipment.Contains(equipment))
                createModel.Equipment.Add(equipment);
        }
        else
        {
            createModel.Equipment.Remove(equipment);
        }
    }

    private async Task HandleValidSubmit()
    {
        isSubmitting = true;
        showValidationSummary = false;
        
        try
        {
            // Convert ExtendedCreateCarListingDto to CreateCarListingDto for API compatibility
            var basicCreateModel = new CreateCarListingDto
            {
                Title = createModel.Title,
                Make = createModel.Make,
                Model = createModel.Model,
                Year = createModel.Year,
                Price = createModel.Price,
                Mileage = createModel.Mileage,
                FuelType = createModel.FuelType,
                Transmission = createModel.Transmission,
                Description = createModel.Description,
                Images = createModel.Images,
                ContactEmail = createModel.ContactEmail,
                ContactPhone = createModel.ContactPhone,
                Location = createModel.Location
            };

            var listing = await CarListingService.CreateCarListingAsync(basicCreateModel);
            Navigation.NavigateTo($"/car/{listing.Id}");
        }
        catch (Exception ex)
        {
            showValidationSummary = true;
            Console.WriteLine($"Error creating listing: {ex.Message}");
        }
        finally
        {
            isSubmitting = false;
        }
    }
}